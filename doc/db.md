# Logi2 Design Doc

## Why

- В отличие от готовых облачно-ориентированных систем, у нас нет
  необходимости и возможности создавать отдельные сервера и
  кластеры для ведения логов. Например для датацентров службы
  мониторинга съедают существенный процент серверов от общего кол-ва,
  где обычно выполняется шардирование данных логов и их индексов.

- zero maintenance: т.е. отсутствие необходимости администрирования.
  Само восстановление сообщений в БД и авто-репликация, автоматическое
  удаление старых сообщений.

- целостность пулов сообщений: подделка журнала должна быть осложнена,
  принцип - все или ничего на поврежденный фрагмент, который
  впрочем в случае утраты будет автореплицирован с дублированного сервера.

- запись важнее записанных данных: возможность продолжать работу
  в случае повреждения части БД за счет отсутствия реляционности.

## Database Text/binary. Tooling

С реализацией хранилища есть возможность оставить читаемость текста(без шифрования),
как например это было бы в универсальных БД. Соответственно все стандартные
утилиты\редакторы могут применяться для просмотра содержимого хранилища.
Однако это не отменяет возможностей по сохранению целостности содержимого,
например добавление спец. блоков или меток в текст, а также создание отдельных
индексов для поддержки поиска. Отказ от текстового формата (возможно сжатого)
должен быть обоснован конкретными преимуществами бинарного представления.
например journald - системная служба логирования использует бинарный формат,
что требует специальной утилиты для чтения\поиска логов.

Существуют гибридные форматы\представления совместимые с текстом, например
протокол NATS <https://docs.nats.io/nats-protocol/nats-protocol>

Для индексов, в том числе для обратных индексов целесообразно использовать
готовые базы типа KeyValue(KV), т.к. они полностью контентно-зависимы, т.е.
могут быть пересозданы с нуля из имеющихся данных. А также индексы должны
иметься только для машин операторов, т.е. только там где выполняется поиск.
